http{
    server {
        listen 80 default_server; 
            
        server_name _; 
        
        return 404; 
    }
    
    server{
        listen 80;
        server_name localhost;
        location /graphql{
            proxy_pass http://system_obslugi_serwisu:8080/graphql/;
            proxy_set_header X-ActingRole "customer";
            
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_read_timeout 86400;
        }
    }
    
    server{
        listen 80;
        server_name repairshop.localhost;
        location /graphql{
            proxy_pass http://system_obslugi_serwisu:8080/graphql/;
            proxy_set_header X-ActingRole "worker";
            
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_read_timeout 86400;
        }
    }
    
    server{
        listen 80;
        server_name storage.localhost;
        location /{
            proxy_pass http://minio:9000;
            
            proxy_set_header Host $host;
        }
    }
}

events{}